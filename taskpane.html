<html>
  <head>
    <title>MS Office Add-In Test</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    <script type="text/javascript">
      function handleClick(e)
      {
        Office.context.document.getSelectedDataAsync(Office.CoercionType.Text, function (asyncResult){
          if(asyncResult.status == Office.AsyncResultStatus.Failed)
          {
            document.getElementById("out").value='Action failed. Error: ' + asyncResult.error.message;
          }
          else
          {
            document.getElementById("out").value='Selected data: ' + asyncResult.value;
          }
        });
      }
    </script>
  </head>
  <body>
    <div>2</div>
    <input type="button" value="Click me!" onclick="handleClick(event);"></input>
    <output id="out"></output>
  </body>
</html>
